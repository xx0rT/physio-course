import{c as u,r as i,j as e,m as s,M as B,s as o,y as n}from"./index-DSbJWJvO.js";/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],_=u("Camera",M);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],T=u("Globe",L);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],S=u("PenLine",R),z=i.memo(({user:t,profile:r,onProfileUpdate:p})=>{var v,N;const[C,c]=i.useState(!1),[h,x]=i.useState(r.bio||""),[m,b]=i.useState(!1),f=i.useRef(null),g=i.useRef(null),w=async(a,l)=>{if(t)try{b(!0);const d=a.name.split(".").pop(),H=`${t._id}-${l}-${Date.now()}.${d}`,y=`${l}s/${H}`,{error:j}=await o.storage.from("user-uploads").upload(y,a,{upsert:!0});if(j)throw j;const{data:{publicUrl:E}}=o.storage.from("user-uploads").getPublicUrl(y),P=l==="profile"?"profile_picture_url":"banner_image_url",{error:k}=await o.from("user_profiles_extended").update({[P]:E}).eq("user_id",t._id);if(k)throw k;n.success(`${l==="profile"?"Profile picture":"Banner"} updated successfully!`),p()}catch(d){console.error("Upload error:",d),n.error("Failed to upload image")}finally{b(!1)}},$=async()=>{if(t)try{const{error:a}=await o.from("user_profiles_extended").update({bio:h}).eq("user_id",t._id);if(a)throw a;n.success("Bio updated successfully!"),c(!1),p()}catch(a){console.error("Error updating bio:",a),n.error("Failed to update bio")}};return e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"relative bg-white dark:bg-neutral-900 rounded-2xl overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"relative h-48 md:h-64 bg-gradient-to-r from-purple-500 to-blue-500 overflow-hidden group",children:[r.banner_image_url&&e.jsx("img",{src:r.banner_image_url,alt:"Banner",className:"w-full h-full object-cover"}),e.jsx(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{var a;return(a=g.current)==null?void 0:a.click()},disabled:m,className:"absolute top-4 right-4 bg-white/90 dark:bg-neutral-800/90 backdrop-blur-sm p-3 rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:e.jsx(_,{className:"w-5 h-5 text-neutral-700 dark:text-neutral-300"})}),e.jsx("input",{ref:g,type:"file",accept:"image/*",onChange:a=>{var l;return((l=a.target.files)==null?void 0:l[0])&&w(a.target.files[0],"banner")},className:"hidden"})]}),e.jsxs("div",{className:"px-6 md:px-8 pb-6",children:[e.jsx("div",{className:"relative -mt-16 md:-mt-20 mb-4",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(s.div,{whileHover:{scale:1.05},className:"w-32 h-32 md:w-40 md:h-40 rounded-full border-4 border-white dark:border-neutral-900 overflow-hidden bg-gradient-to-br from-purple-500 to-blue-500 shadow-xl",children:r.profile_picture_url?e.jsx("img",{src:r.profile_picture_url,alt:`${t.firstName} ${t.lastName}`,className:"w-full h-full object-cover"}):e.jsxs("div",{className:"w-full h-full flex items-center justify-center text-white text-4xl md:text-5xl font-bold",children:[(v=t.firstName)==null?void 0:v[0],(N=t.lastName)==null?void 0:N[0]]})}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>{var a;return(a=f.current)==null?void 0:a.click()},disabled:m,className:"absolute bottom-2 right-2 bg-white dark:bg-neutral-800 p-2.5 rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",children:e.jsx(_,{className:"w-4 h-4 text-neutral-700 dark:text-neutral-300"})}),e.jsx("input",{ref:f,type:"file",accept:"image/*",onChange:a=>{var l;return((l=a.target.files)==null?void 0:l[0])&&w(a.target.files[0],"profile")},className:"hidden"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-neutral-900 dark:text-white",children:[t.firstName," ",t.lastName]}),e.jsx("p",{className:"text-neutral-600 dark:text-neutral-400 text-lg",children:t.email})]}),e.jsx("div",{className:"space-y-2",children:C?e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{value:h,onChange:a=>x(a.target.value),placeholder:"Tell us about yourself...",className:"w-full p-3 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 text-neutral-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",rows:3,maxLength:200}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:$,className:"px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors",children:"Save"}),e.jsx(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{c(!1),x(r.bio||"")},className:"px-4 py-2 bg-neutral-200 dark:bg-neutral-700 text-neutral-700 dark:text-neutral-300 rounded-lg font-medium hover:bg-neutral-300 dark:hover:bg-neutral-600 transition-colors",children:"Cancel"})]})]}):e.jsxs("div",{className:"flex items-start gap-2 group",children:[e.jsx("p",{className:"text-neutral-700 dark:text-neutral-300 flex-1",children:r.bio||"No bio yet. Click to add one!"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>c(!0),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1",children:e.jsx(S,{className:"w-4 h-4 text-neutral-500 dark:text-neutral-400"})})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-neutral-600 dark:text-neutral-400",children:[r.location&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:r.location})]}),r.website&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("a",{href:r.website,target:"_blank",rel:"noopener noreferrer",className:"hover:text-purple-600 dark:hover:text-purple-400 transition-colors",children:r.website.replace(/^https?:\/\//,"")})]})]})]})]})]})});z.displayName="ProfileHeader";export{z as default};
